!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self)["core-request-base"]={})}(this,function(e){"use strict";var t="undefined"==typeof window?(global.$mall||(global.$mall={}),global.$mall):(window.$mall||(window.$mall={}),window.$mall);t.__request_pending__={};function o(e){return encodeURIComponent(JSON.stringify(e))}var r=function(e,n){var a=1<arguments.length&&void 0!==n&&n;t.__request_pending__[e]&&a&&t.__request_pending__[e]("abort"),delete t.__request_pending__[e]};e.complete=function(e,n){var a=e.code;if(void 0===a)return e;switch(a){case 0:return e.data;case-1:var t={message:"系统错误",info:"".concat(e.msg,": ").concat(n.options.url),data:e};return Promise.reject(t);default:var o={message:e.msg,info:"".concat(e.msg,": ").concat(n.options.url),data:e};return Promise.reject(o)}},e.defaultConfig=function(){return{withCredentials:!1,timeout:15e3,headers:{"Content-Type":"application/json;charset=utf-8"}}},e.filterError=function(e){var n="";switch(e.status){case 400:n="请求错误";break;case 401:n="未授权，请登录";break;case 403:n="拒绝访问";break;case 404:n="请求地址出错: ".concat(e.config.url);break;case 408:n="请求超时";break;case 500:n="服务器内部错误";break;case 501:n="服务未实现";break;case 502:n="网关错误";break;case 503:n="服务不可用";break;case 504:n="网关超时";break;case 505:n="HTTP版本不受支持"}if(200===e.status||n||(n="系统繁忙，请稍后再试"),n)return Promise.reject({message:n,response:e})},e.filterResponse=function(e){console.groupCollapsed("%cresponse debug: %c".concat(e.config.url),"color: #999","color: #0076ff"),console.log(e.config),console.log(e.data),console.groupEnd();var n=o(e.config);return r(n),e.data},e.formatParams=function(a){var t={};return Object.keys(a.params).forEach(function(e){var n=Object.prototype.toString.call(a.params[e]);n.includes("Array")&&(a.params[e]=a.params[e].join(",")),t[e]=encodeURIComponent(n.includes("Object")?JSON.stringify(a.params[e]):a.params[e])}),a.url=function(e,n){var a=1<arguments.length&&void 0!==n?n:"";for(var t in e)if(-1===a.indexOf(t)){var o=-1<a.indexOf("?")?"&":"?";a=/(\#\/.+)$/g.test(a)?a.replace(/(\#\/.+)$/g,o+"".concat(t,"=").concat(e[t])+"$1"):a+o+"".concat(t,"=").concat(e[t])}return a}(t,a.url),delete a.params,a},e.getRequestIdentify=o,e.initialize=function(e){console.log("baseURL",e),t.__base_url__=e},e.pendding=function(e,n){var a=o(e);r(a,!0),t.__request_pending__[a]=n},e.removePending=r,Object.defineProperty(e,"__esModule",{value:!0})});
