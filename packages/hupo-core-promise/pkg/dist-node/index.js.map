{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["import global from '@hupo/core-global';\nif (!global.promise) global.promise = {};\n\nconst isRegExp = reg => Object.prototype.toString.call(reg) === '[object RegExp]';\n\nexport const exit = message => Promise.reject(new Error(message));\nexport const cache = async (id, promise) => {\n  if (!global.promise[id]) {\n    global.promise[id] = promise();\n  }\n\n  try {\n    return await global.promise[id];\n  } catch (error) {\n    global.promise[id] = null;\n    delete global.promise[id];\n    return exit(error);\n  }\n};\nexport const del = id => {\n  // 正则匹配\n  if (isRegExp(id)) {\n    Object.keys(global.promise).forEach(key => {\n      if (id.test(key)) {\n        global.promise[key] = null;\n        delete global.promise[key];\n      }\n    });\n  } else if (global.promise[id]) {\n    global.promise[id] = null;\n    delete global.promise[id];\n  }\n};\nexport const delay = time => new Promise(resolve => {\n  setTimeout(resolve, time);\n});\nexport default {\n  exit,\n  cache,\n  del,\n  delay\n};"],"names":["global","promise","isRegExp","reg","Object","prototype","toString","call","exit","message","Promise","reject","Error","cache","id","error","del","keys","forEach","key","test","delay","time","resolve","setTimeout"],"mappings":";;;;;;;;AACA,IAAI,CAACA,MAAM,CAACC,OAAZ,EAAqBD,MAAM,CAACC,OAAP,GAAiB,EAAjB;;AAErB,MAAMC,QAAQ,GAAGC,GAAG,IAAIC,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BJ,GAA/B,MAAwC,iBAAhE;;AAEA,MAAaK,IAAI,GAAGC,OAAO,IAAIC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAUH,OAAV,CAAf,CAAxB;AACP,MAAaI,KAAK,GAAG,OAAOC,EAAP,EAAWb,OAAX,KAAuB;MACtC,CAACD,MAAM,CAACC,OAAP,CAAea,EAAf,CAAL,EAAyB;IACvBd,MAAM,CAACC,OAAP,CAAea,EAAf,IAAqBb,OAAO,EAA5B;;;MAGE;WACK,MAAMD,MAAM,CAACC,OAAP,CAAea,EAAf,CAAb;GADF,CAEE,OAAOC,KAAP,EAAc;IACdf,MAAM,CAACC,OAAP,CAAea,EAAf,IAAqB,IAArB;WACOd,MAAM,CAACC,OAAP,CAAea,EAAf,CAAP;WACON,IAAI,CAACO,KAAD,CAAX;;CAVG;AAaP,MAAaC,GAAG,GAAGF,EAAE,IAAI;;MAEnBZ,QAAQ,CAACY,EAAD,CAAZ,EAAkB;IAChBV,MAAM,CAACa,IAAP,CAAYjB,MAAM,CAACC,OAAnB,EAA4BiB,OAA5B,CAAoCC,GAAG,IAAI;UACrCL,EAAE,CAACM,IAAH,CAAQD,GAAR,CAAJ,EAAkB;QAChBnB,MAAM,CAACC,OAAP,CAAekB,GAAf,IAAsB,IAAtB;eACOnB,MAAM,CAACC,OAAP,CAAekB,GAAf,CAAP;;KAHJ;GADF,MAOO,IAAInB,MAAM,CAACC,OAAP,CAAea,EAAf,CAAJ,EAAwB;IAC7Bd,MAAM,CAACC,OAAP,CAAea,EAAf,IAAqB,IAArB;WACOd,MAAM,CAACC,OAAP,CAAea,EAAf,CAAP;;CAXG;AAcP,MAAaO,KAAK,GAAGC,IAAI,IAAI,IAAIZ,OAAJ,CAAYa,OAAO,IAAI;EAClDC,UAAU,CAACD,OAAD,EAAUD,IAAV,CAAV;CAD2B,CAAtB;AAGP,YAAe;EACbd,IADa;EAEbK,KAFa;EAGbG,GAHa;EAIbK;CAJF;;;;;;;;"}