{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["// 特别指定的wx对象中不进行Promise封装的方法\nconst noPromiseMethods = {\n  clearStorage: 1,\n  hideToast: 1,\n  hideLoading: 1,\n  drawCanvas: 1,\n  canIUse: 1,\n  stopRecord: 1,\n  pauseVoice: 1,\n  stopVoice: 1,\n  pauseBackgroundAudio: 1,\n  stopBackgroundAudio: 1,\n  showNavigationBarLoading: 1,\n  hideNavigationBarLoading: 1,\n  createAnimation: 1,\n  createSelectorQuery: 1,\n  hideKeyboard: 1,\n  stopPullDownRefresh: 1,\n  createWorker: 1,\n  pageScrollTo: 1,\n  reportAnalytics: 1\n};\nconst wxTools = {};\n\nif (typeof wx !== 'undefined') {\n  Object.keys(wx).forEach(key => {\n    if (noPromiseMethods[key] || // 特别指定的方法\n    /^get\\w*Manager$/.test(key) || // 获取manager的api\n    /^create\\w*Context$/.test(key) || // 创建上下文相关api\n    /^(on|off)/.test(key) || // 以 on* 或 off开头的方法\n    /\\w+Sync$/.test(key) // 以 Sync 结尾的方法\n    ) {\n      // 不进行Promise封装\n      wxTools[key] = function () {\n        const res = wx[key].apply(wx, arguments);\n        return res;\n      };\n\n      return;\n    } // 其余方法自动Promise化\n\n\n    wxTools[key] = function (obj = {}) {\n      // if (key === 'showModal') {\n      //   // 按钮统一色调\n      //   obj = Object.assign({\n      //     confirmColor: color.primary\n      //   }, obj)\n      // }\n      return new Promise((resolve, reject) => {\n        const originSuccess = obj.success;\n        const originFail = obj.fail;\n\n        obj.success = function (res) {\n          originSuccess && originSuccess.apply(this, arguments);\n          resolve(res);\n        };\n\n        obj.fail = function (res) {\n          console.log(obj, res);\n          originFail && originFail.apply(this, arguments);\n          reject(res);\n        };\n\n        wx[key](obj);\n      });\n    };\n  });\n}\n\nwxTools.$nextTick = (delay = 500) => new Promise((resolve, reject) => {\n  if (wxTools.nextTick) {\n    wxTools.nextTick(resolve);\n  } else {\n    setTimeout(() => {\n      resolve();\n    }, delay);\n  }\n});\n\nexport default wxTools;"],"names":["noPromiseMethods","clearStorage","hideToast","hideLoading","drawCanvas","canIUse","stopRecord","pauseVoice","stopVoice","pauseBackgroundAudio","stopBackgroundAudio","showNavigationBarLoading","hideNavigationBarLoading","createAnimation","createSelectorQuery","hideKeyboard","stopPullDownRefresh","createWorker","pageScrollTo","reportAnalytics","wxTools","wx","Object","keys","forEach","key","test","res","apply","arguments","obj","Promise","resolve","reject","originSuccess","success","originFail","fail","console","log","$nextTick","delay","nextTick","setTimeout"],"mappings":";;;;AAAA;AACA,MAAMA,gBAAgB,GAAG;EACvBC,YAAY,EAAE,CADS;EAEvBC,SAAS,EAAE,CAFY;EAGvBC,WAAW,EAAE,CAHU;EAIvBC,UAAU,EAAE,CAJW;EAKvBC,OAAO,EAAE,CALc;EAMvBC,UAAU,EAAE,CANW;EAOvBC,UAAU,EAAE,CAPW;EAQvBC,SAAS,EAAE,CARY;EASvBC,oBAAoB,EAAE,CATC;EAUvBC,mBAAmB,EAAE,CAVE;EAWvBC,wBAAwB,EAAE,CAXH;EAYvBC,wBAAwB,EAAE,CAZH;EAavBC,eAAe,EAAE,CAbM;EAcvBC,mBAAmB,EAAE,CAdE;EAevBC,YAAY,EAAE,CAfS;EAgBvBC,mBAAmB,EAAE,CAhBE;EAiBvBC,YAAY,EAAE,CAjBS;EAkBvBC,YAAY,EAAE,CAlBS;EAmBvBC,eAAe,EAAE;CAnBnB;AAqBA,MAAMC,OAAO,GAAG,EAAhB;;AAEA,IAAI,OAAOC,EAAP,KAAc,WAAlB,EAA+B;EAC7BC,MAAM,CAACC,IAAP,CAAYF,EAAZ,EAAgBG,OAAhB,CAAwBC,GAAG,IAAI;QACzBzB,gBAAgB,CAACyB,GAAD,CAAhB;sBACcC,IAAlB,CAAuBD,GAAvB,CADI;yBAEiBC,IAArB,CAA0BD,GAA1B,CAFI;gBAGQC,IAAZ,CAAiBD,GAAjB,CAHI;eAIOC,IAAX,CAAgBD,GAAhB,CAJA;MAKE;;MAEAL,OAAO,CAACK,GAAD,CAAP,GAAe,YAAY;cACnBE,GAAG,GAAGN,EAAE,CAACI,GAAD,CAAF,CAAQG,KAAR,CAAcP,EAAd,EAAkBQ,SAAlB,CAAZ;eACOF,GAAP;OAFF;;;KAR2B;;;IAiB7BP,OAAO,CAACK,GAAD,CAAP,GAAe,UAAUK,GAAG,GAAG,EAAhB,EAAoB;;;;;;;aAO1B,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;cAChCC,aAAa,GAAGJ,GAAG,CAACK,OAA1B;cACMC,UAAU,GAAGN,GAAG,CAACO,IAAvB;;QAEAP,GAAG,CAACK,OAAJ,GAAc,UAAUR,GAAV,EAAe;UAC3BO,aAAa,IAAIA,aAAa,CAACN,KAAd,CAAoB,IAApB,EAA0BC,SAA1B,CAAjB;UACAG,OAAO,CAACL,GAAD,CAAP;SAFF;;QAKAG,GAAG,CAACO,IAAJ,GAAW,UAAUV,GAAV,EAAe;UACxBW,OAAO,CAACC,GAAR,CAAYT,GAAZ,EAAiBH,GAAjB;UACAS,UAAU,IAAIA,UAAU,CAACR,KAAX,CAAiB,IAAjB,EAAuBC,SAAvB,CAAd;UACAI,MAAM,CAACN,GAAD,CAAN;SAHF;;QAMAN,EAAE,CAACI,GAAD,CAAF,CAAQK,GAAR;OAfK,CAAP;KAPF;GAjBF;;;AA6CFV,OAAO,CAACoB,SAAR,GAAoB,CAACC,KAAK,GAAG,GAAT,KAAiB,IAAIV,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;MAChEb,OAAO,CAACsB,QAAZ,EAAsB;IACpBtB,OAAO,CAACsB,QAAR,CAAiBV,OAAjB;GADF,MAEO;IACLW,UAAU,CAAC,MAAM;MACfX,OAAO;KADC,EAEPS,KAFO,CAAV;;CAJiC,CAArC;;;;"}