{"version":3,"file":"index.js","sources":["../dist-src/utils.js","../dist-src/BaseTree.js","../dist-src/mixins/component.js","../dist-src/mixins/page.js","../dist-src/index.js"],"sourcesContent":["export const getViewId = instance => instance._uid ? instance._uid : instance.__wxWebviewId__ || instance.getPageId();\nexport const getComponentName = instance => instance.__cml_originOptions__ ? instance.__cml_originOptions__.name : instance.$options.name;","import { getViewId, getComponentName } from \"./utils.js\";\nexport default class BaseTree {\n  constructor() {\n    this.initialize();\n  }\n\n  initialize() {\n    this.pages = {};\n  }\n\n  addPage(page) {\n    const viewId = getViewId(page);\n    page._children = {};\n    if (!this.pages[viewId]) this.pages[viewId] = page;\n  }\n\n  removePage(page) {\n    const viewId = getViewId(page);\n    delete this.pages[viewId];\n  }\n\n  addComponent(component) {\n    const name = getComponentName(component);\n\n    if (!name) {\n      console.warn('you have to add name of component', component);\n      return;\n    }\n\n    const instance = component.$route ? component.$route.matched[0].instances.default : component;\n    const viewId = getViewId(instance);\n    const page = this.pages[viewId];\n    component._page = page;\n    if (!page._children[name]) page._children[name] = [];\n\n    page._children[name].push(component);\n  }\n\n  removeComponent(component) {\n    const name = getComponentName(component);\n\n    if (!name) {\n      console.warn('you have to add name of component', component);\n      return;\n    }\n\n    Object.keys(this.pages).forEach(key => {\n      const page = this.pages[key];\n\n      if (page && page._children[name]) {\n        page._children[name].splice(page._children[name].indexOf(component) >>> 0, 1);\n      }\n    });\n  }\n\n}","import global from '@hupo/core-global';\nexport default {\n  mounted() {\n    global._baseTree.addComponent(this);\n  },\n\n  beforeDestroy() {\n    global._baseTree.removeComponent(this);\n  }\n\n};","import global from '@hupo/core-global';\nexport default {\n  beforeCreate() {\n    global._baseTree.addPage(this);\n  },\n\n  beforeDestroy() {\n    global._baseTree.removePage(this);\n  }\n\n};","import global from '@hupo/core-global';\nimport BaseTree from \"./BaseTree.js\";\nexport { default as componentBaseTreeMixin } from \"./mixins/component.js\";\nexport { default as pageBaseTreeMixin } from \"./mixins/page.js\";\nglobal._baseTree = new BaseTree();"],"names":["getViewId","instance","_uid","__wxWebviewId__","getPageId","getComponentName","__cml_originOptions__","name","$options","BaseTree","constructor","initialize","pages","addPage","page","viewId","_children","removePage","addComponent","component","console","warn","$route","matched","instances","default","_page","push","removeComponent","Object","keys","forEach","key","splice","indexOf","mounted","global","_baseTree","beforeDestroy","beforeCreate"],"mappings":";;;;;;;;AAAO,MAAMA,SAAS,GAAGC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACC,IAAzB,GAAgCD,QAAQ,CAACE,eAAT,IAA4BF,QAAQ,CAACG,SAAT,EAA1F;AACP,AAAO,MAAMC,gBAAgB,GAAGJ,QAAQ,IAAIA,QAAQ,CAACK,qBAAT,GAAiCL,QAAQ,CAACK,qBAAT,CAA+BC,IAAhE,GAAuEN,QAAQ,CAACO,QAAT,CAAkBD,IAA9H;;ACAQ,MAAME,QAAN,CAAe;EAC5BC,WAAW,GAAG;SACPC,UAAL;;;EAGFA,UAAU,GAAG;SACNC,KAAL,GAAa,EAAb;;;EAGFC,OAAO,CAACC,IAAD,EAAO;UACNC,MAAM,GAAGf,SAAS,CAACc,IAAD,CAAxB;IACAA,IAAI,CAACE,SAAL,GAAiB,EAAjB;QACI,CAAC,KAAKJ,KAAL,CAAWG,MAAX,CAAL,EAAyB,KAAKH,KAAL,CAAWG,MAAX,IAAqBD,IAArB;;;EAG3BG,UAAU,CAACH,IAAD,EAAO;UACTC,MAAM,GAAGf,SAAS,CAACc,IAAD,CAAxB;WACO,KAAKF,KAAL,CAAWG,MAAX,CAAP;;;EAGFG,YAAY,CAACC,SAAD,EAAY;UAChBZ,IAAI,GAAGF,gBAAgB,CAACc,SAAD,CAA7B;;QAEI,CAACZ,IAAL,EAAW;MACTa,OAAO,CAACC,IAAR,CAAa,mCAAb,EAAkDF,SAAlD;;;;UAIIlB,QAAQ,GAAGkB,SAAS,CAACG,MAAV,GAAmBH,SAAS,CAACG,MAAV,CAAiBC,OAAjB,CAAyB,CAAzB,EAA4BC,SAA5B,CAAsCC,OAAzD,GAAmEN,SAApF;UACMJ,MAAM,GAAGf,SAAS,CAACC,QAAD,CAAxB;UACMa,IAAI,GAAG,KAAKF,KAAL,CAAWG,MAAX,CAAb;IACAI,SAAS,CAACO,KAAV,GAAkBZ,IAAlB;QACI,CAACA,IAAI,CAACE,SAAL,CAAeT,IAAf,CAAL,EAA2BO,IAAI,CAACE,SAAL,CAAeT,IAAf,IAAuB,EAAvB;;IAE3BO,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqBoB,IAArB,CAA0BR,SAA1B;;;EAGFS,eAAe,CAACT,SAAD,EAAY;UACnBZ,IAAI,GAAGF,gBAAgB,CAACc,SAAD,CAA7B;;QAEI,CAACZ,IAAL,EAAW;MACTa,OAAO,CAACC,IAAR,CAAa,mCAAb,EAAkDF,SAAlD;;;;IAIFU,MAAM,CAACC,IAAP,CAAY,KAAKlB,KAAjB,EAAwBmB,OAAxB,CAAgCC,GAAG,IAAI;YAC/BlB,IAAI,GAAG,KAAKF,KAAL,CAAWoB,GAAX,CAAb;;UAEIlB,IAAI,IAAIA,IAAI,CAACE,SAAL,CAAeT,IAAf,CAAZ,EAAkC;QAChCO,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqB0B,MAArB,CAA4BnB,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqB2B,OAArB,CAA6Bf,SAA7B,MAA4C,CAAxE,EAA2E,CAA3E;;KAJJ;;;;;AC7CJ,gBAAe;EACbgB,OAAO,GAAG;IACRC,MAAM,CAACC,SAAP,CAAiBnB,YAAjB,CAA8B,IAA9B;GAFW;;EAKboB,aAAa,GAAG;IACdF,MAAM,CAACC,SAAP,CAAiBT,eAAjB,CAAiC,IAAjC;;;CANJ;;ACAA,WAAe;EACbW,YAAY,GAAG;IACbH,MAAM,CAACC,SAAP,CAAiBxB,OAAjB,CAAyB,IAAzB;GAFW;;EAKbyB,aAAa,GAAG;IACdF,MAAM,CAACC,SAAP,CAAiBpB,UAAjB,CAA4B,IAA5B;;;CANJ;;ACGAmB,MAAM,CAACC,SAAP,GAAmB,IAAI5B,QAAJ,EAAnB;;;;;"}