{"version":3,"file":"index.js","sources":["../dist-src/baseTree/index.js","../dist-src/mixins/component.js","../dist-src/mixins/page.js"],"sourcesContent":["// 初始化 page id，判断组件和page是否在同一个page\nfunction initInstance(instance) {\n  Object.defineProperty(instance, '__page__id__', {\n    get() {\n      return this.__wxWebviewId__ || this.getPageId();\n    },\n\n    configurable: false,\n    enumerable: false\n  });\n}\n\nexport function addPage(page) {\n  initInstance(page);\n  page._children = {};\n}\nexport function addComponent(component) {\n  initInstance(component); // 添加componentName\n\n  Object.defineProperty(component, 'componentName', {\n    get() {\n      return this.__cml_originOptions__.name;\n    },\n\n    configurable: false,\n    enumerable: false\n  }); // 添加_page，可直接使用this._page获取到当前page\n\n  Object.defineProperty(component, '_page', {\n    get() {\n      return getCurrentPages().find(item => item.__page__id__ === this.__page__id__);\n    },\n\n    configurable: false,\n    enumerable: false\n  });\n\n  if (!component.componentName) {\n    console.warn('you have to add name of component', component);\n    return;\n  }\n\n  if (!component._page._children[component.componentName]) component._page._children[component.componentName] = [];\n\n  component._page._children[component.componentName].push(component);\n}\nexport function removeComponent(component) {\n  if (component && component.componentName && component._page && component._page._children[component.componentName]) {\n    const index = component._page._children[component.componentName].indexOf(component);\n\n    if (index > -1) {\n      component._page._children[component.componentName].splice(index, 1);\n    }\n  }\n}","import { addComponent, removeComponent } from \"../baseTree/index.js\";\nexport const componentBaseTreeMixin = {\n  mounted() {\n    addComponent(this);\n  },\n\n  beforeDestroy() {\n    removeComponent(this);\n  }\n\n};","import { addPage } from \"../baseTree/index.js\";\nexport const pageBaseTreeMixin = {\n  beforeCreate() {\n    addPage(this);\n  }\n\n};"],"names":["initInstance","instance","Object","defineProperty","get","__wxWebviewId__","getPageId","configurable","enumerable","addPage","page","_children","addComponent","component","__cml_originOptions__","name","getCurrentPages","find","item","__page__id__","componentName","console","warn","_page","push","removeComponent","index","indexOf","splice","componentBaseTreeMixin","mounted","beforeDestroy","pageBaseTreeMixin","beforeCreate"],"mappings":";;;;AAAA;AACA,SAASA,YAAT,CAAsBC,QAAtB,EAAgC;EAC9BC,MAAM,CAACC,cAAP,CAAsBF,QAAtB,EAAgC,cAAhC,EAAgD;IAC9CG,GAAG,GAAG;aACG,KAAKC,eAAL,IAAwB,KAAKC,SAAL,EAA/B;KAF4C;;IAK9CC,YAAY,EAAE,KALgC;IAM9CC,UAAU,EAAE;GANd;;;AAUF,AAAO,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;EAC5BV,YAAY,CAACU,IAAD,CAAZ;EACAA,IAAI,CAACC,SAAL,GAAiB,EAAjB;;AAEF,AAAO,SAASC,YAAT,CAAsBC,SAAtB,EAAiC;EACtCb,YAAY,CAACa,SAAD,CAAZ,CADsC;;EAGtCX,MAAM,CAACC,cAAP,CAAsBU,SAAtB,EAAiC,eAAjC,EAAkD;IAChDT,GAAG,GAAG;aACG,KAAKU,qBAAL,CAA2BC,IAAlC;KAF8C;;IAKhDR,YAAY,EAAE,KALkC;IAMhDC,UAAU,EAAE;GANd,EAHsC;;EAYtCN,MAAM,CAACC,cAAP,CAAsBU,SAAtB,EAAiC,OAAjC,EAA0C;IACxCT,GAAG,GAAG;aACGY,eAAe,GAAGC,IAAlB,CAAuBC,IAAI,IAAIA,IAAI,CAACC,YAAL,KAAsB,KAAKA,YAA1D,CAAP;KAFsC;;IAKxCZ,YAAY,EAAE,KAL0B;IAMxCC,UAAU,EAAE;GANd;;MASI,CAACK,SAAS,CAACO,aAAf,EAA8B;IAC5BC,OAAO,CAACC,IAAR,CAAa,mCAAb,EAAkDT,SAAlD;;;;MAIE,CAACA,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,CAAL,EAAyDP,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,IAAqD,EAArD;;EAEzDP,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,EAAmDI,IAAnD,CAAwDX,SAAxD;;AAEF,AAAO,SAASY,eAAT,CAAyBZ,SAAzB,EAAoC;MACrCA,SAAS,IAAIA,SAAS,CAACO,aAAvB,IAAwCP,SAAS,CAACU,KAAlD,IAA2DV,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,CAA/D,EAAmH;UAC3GM,KAAK,GAAGb,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,EAAmDO,OAAnD,CAA2Dd,SAA3D,CAAd;;QAEIa,KAAK,GAAG,CAAC,CAAb,EAAgB;MACdb,SAAS,CAACU,KAAV,CAAgBZ,SAAhB,CAA0BE,SAAS,CAACO,aAApC,EAAmDQ,MAAnD,CAA0DF,KAA1D,EAAiE,CAAjE;;;;;MClDOG,sBAAsB,GAAG;EACpCC,OAAO,GAAG;IACRlB,YAAY,CAAC,IAAD,CAAZ;GAFkC;;EAKpCmB,aAAa,GAAG;IACdN,eAAe,CAAC,IAAD,CAAf;;;CANG;;MCAMO,iBAAiB,GAAG;EAC/BC,YAAY,GAAG;IACbxB,OAAO,CAAC,IAAD,CAAP;;;CAFG;;;;;"}