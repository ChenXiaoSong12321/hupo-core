{"version":3,"file":"index.js","sources":["../dist-src/utils.js","../dist-src/BaseTree.js","../dist-src/mixins/component.js","../dist-src/mixins/page.js","../dist-src/index.js"],"sourcesContent":["export const getViewId = instance => instance._uid ? instance._uid : instance.__wxWebviewId__ || instance.getPageId();\nexport const getComponentName = instance => instance.__cml_originOptions__ ? instance.__cml_originOptions__.name : instance.$options.name;","import { getViewId, getComponentName } from \"./utils.js\";\nexport default class BaseTree {\n  constructor() {\n    this.initialize();\n  }\n\n  initialize() {\n    this.pages = {};\n  }\n\n  addPage(page) {\n    const viewId = getViewId(page);\n    page._children = {};\n    if (!this.pages[viewId]) this.pages[viewId] = page;\n  }\n\n  removePage(page) {\n    const viewId = getViewId(page);\n    delete this.pages[viewId];\n  }\n\n  addComponent(component) {\n    const name = getComponentName(component);\n\n    if (!name) {\n      console.warn('you have to add name of component', component);\n      return;\n    }\n\n    const instance = component.$route ? component.$route.matched[0].instances.default : component;\n    const viewId = getViewId(instance);\n    const page = this.pages[viewId];\n    component._page = page;\n    if (!page._children[name]) page._children[name] = [];\n\n    page._children[name].push(component);\n  }\n\n  removeComponent(component) {\n    const name = getComponentName(component);\n\n    if (!name) {\n      console.warn('you have to add name of component', component);\n      return;\n    }\n\n    const viewId = getViewId(component._page || component);\n    const page = this.pages[viewId];\n\n    if (page && page._children[name]) {\n      page._children[name].splice(page._children[name].indexOf(component) >>> 0, 1);\n    }\n  }\n\n}","import global from '@hupo/core-global';\nexport default {\n  mounted() {\n    global._baseTree.addComponent(this);\n  },\n\n  beforeDestroy() {\n    global._baseTree.removeComponent(this);\n  }\n\n};","import global from '@hupo/core-global';\nexport default {\n  beforeCreate() {\n    global._baseTree.addPage(this);\n  },\n\n  beforeDestroy() {\n    global._baseTree.removePage(this);\n  }\n\n};","import global from '@hupo/core-global';\nimport BaseTree from \"./BaseTree.js\";\nexport { default as componentBaseTreeMixin } from \"./mixins/component.js\";\nexport { default as pageBaseTreeMixin } from \"./mixins/page.js\";\nglobal._baseTree = new BaseTree();"],"names":["getViewId","instance","_uid","__wxWebviewId__","getPageId","getComponentName","__cml_originOptions__","name","$options","BaseTree","constructor","initialize","pages","addPage","page","viewId","_children","removePage","addComponent","component","console","warn","$route","matched","instances","default","_page","push","removeComponent","splice","indexOf","mounted","global","_baseTree","beforeDestroy","beforeCreate"],"mappings":";;;;;;;;AAAO,MAAMA,SAAS,GAAGC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,GAAgBD,QAAQ,CAACC,IAAzB,GAAgCD,QAAQ,CAACE,eAAT,IAA4BF,QAAQ,CAACG,SAAT,EAA1F;AACP,AAAO,MAAMC,gBAAgB,GAAGJ,QAAQ,IAAIA,QAAQ,CAACK,qBAAT,GAAiCL,QAAQ,CAACK,qBAAT,CAA+BC,IAAhE,GAAuEN,QAAQ,CAACO,QAAT,CAAkBD,IAA9H;;ACAQ,MAAME,QAAN,CAAe;EAC5BC,WAAW,GAAG;SACPC,UAAL;;;EAGFA,UAAU,GAAG;SACNC,KAAL,GAAa,EAAb;;;EAGFC,OAAO,CAACC,IAAD,EAAO;UACNC,MAAM,GAAGf,SAAS,CAACc,IAAD,CAAxB;IACAA,IAAI,CAACE,SAAL,GAAiB,EAAjB;QACI,CAAC,KAAKJ,KAAL,CAAWG,MAAX,CAAL,EAAyB,KAAKH,KAAL,CAAWG,MAAX,IAAqBD,IAArB;;;EAG3BG,UAAU,CAACH,IAAD,EAAO;UACTC,MAAM,GAAGf,SAAS,CAACc,IAAD,CAAxB;WACO,KAAKF,KAAL,CAAWG,MAAX,CAAP;;;EAGFG,YAAY,CAACC,SAAD,EAAY;UAChBZ,IAAI,GAAGF,gBAAgB,CAACc,SAAD,CAA7B;;QAEI,CAACZ,IAAL,EAAW;MACTa,OAAO,CAACC,IAAR,CAAa,mCAAb,EAAkDF,SAAlD;;;;UAIIlB,QAAQ,GAAGkB,SAAS,CAACG,MAAV,GAAmBH,SAAS,CAACG,MAAV,CAAiBC,OAAjB,CAAyB,CAAzB,EAA4BC,SAA5B,CAAsCC,OAAzD,GAAmEN,SAApF;UACMJ,MAAM,GAAGf,SAAS,CAACC,QAAD,CAAxB;UACMa,IAAI,GAAG,KAAKF,KAAL,CAAWG,MAAX,CAAb;IACAI,SAAS,CAACO,KAAV,GAAkBZ,IAAlB;QACI,CAACA,IAAI,CAACE,SAAL,CAAeT,IAAf,CAAL,EAA2BO,IAAI,CAACE,SAAL,CAAeT,IAAf,IAAuB,EAAvB;;IAE3BO,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqBoB,IAArB,CAA0BR,SAA1B;;;EAGFS,eAAe,CAACT,SAAD,EAAY;UACnBZ,IAAI,GAAGF,gBAAgB,CAACc,SAAD,CAA7B;;QAEI,CAACZ,IAAL,EAAW;MACTa,OAAO,CAACC,IAAR,CAAa,mCAAb,EAAkDF,SAAlD;;;;UAIIJ,MAAM,GAAGf,SAAS,CAACmB,SAAS,CAACO,KAAV,IAAmBP,SAApB,CAAxB;UACML,IAAI,GAAG,KAAKF,KAAL,CAAWG,MAAX,CAAb;;QAEID,IAAI,IAAIA,IAAI,CAACE,SAAL,CAAeT,IAAf,CAAZ,EAAkC;MAChCO,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqBsB,MAArB,CAA4Bf,IAAI,CAACE,SAAL,CAAeT,IAAf,EAAqBuB,OAArB,CAA6BX,SAA7B,MAA4C,CAAxE,EAA2E,CAA3E;;;;;;ACjDN,gBAAe;EACbY,OAAO,GAAG;IACRC,MAAM,CAACC,SAAP,CAAiBf,YAAjB,CAA8B,IAA9B;GAFW;;EAKbgB,aAAa,GAAG;IACdF,MAAM,CAACC,SAAP,CAAiBL,eAAjB,CAAiC,IAAjC;;;CANJ;;ACAA,WAAe;EACbO,YAAY,GAAG;IACbH,MAAM,CAACC,SAAP,CAAiBpB,OAAjB,CAAyB,IAAzB;GAFW;;EAKbqB,aAAa,GAAG;IACdF,MAAM,CAACC,SAAP,CAAiBhB,UAAjB,CAA4B,IAA5B;;;CANJ;;ACGAe,MAAM,CAACC,SAAP,GAAmB,IAAIxB,QAAJ,EAAnB;;;;;"}