!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@hupo/core-global"),require("@hupo/core-promise"),require("@hupo/core-wx-app-tools"),require("@hupo/core-dayjs")):"function"==typeof define&&define.amd?define(["exports","@hupo/core-global","@hupo/core-promise","@hupo/core-wx-app-tools","@hupo/core-dayjs"],n):n((e=e||self).core={},e.coreGlobal,e.corePromise,e.coreWxAppTools,e.coreDayjs)}(this,function(e,n,t,o,r){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n,t=t&&t.hasOwnProperty("default")?t.default:t,o=o&&o.hasOwnProperty("default")?o.default:o,r=r&&r.hasOwnProperty("default")?r.default:r;var i="undefined"==typeof window?global:window;function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function s(e){return e.__wxWebviewId__||e.$route.path}function u(e){return e.__cml_originOptions__?e.__cml_originOptions__.componentName:e.$options.componentName}var c=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.initialize()}return function(e,n,t){n&&a(e.prototype,n),t&&a(e,t)}(e,[{key:"initialize",value:function(){this.pages={}}},{key:"addPage",value:function(e){var n=s(e);e._children={},this.pages[n]||(this.pages[n]=e)}},{key:"removePage",value:function(e){var n=s(e);delete this.pages[n]}},{key:"addComponent",value:function(e){var n=u(e);if(n){var t=s(e),o=this.pages[t];o._children[n]||(o._children[n]=[]),o._children[n].push(e),e._page=o}else console.warn("you have to add componentName of component",e)}},{key:"removeComponent",value:function(e){var n=u(e);if(n){var t=s(e),o=this.pages[t];o&&o._children[n]&&o._children[n].splice(o._children[n].indexOf(e)>>>0,1)}else console.warn("you have to add componentName of component",e)}}]),e}(),l={created:function(){global._baseTree.addComponent(this)},beforeDestroy:function(){global._baseTree.removeComponent(this)}},f={created:function(){global._baseTree.addPage(this)},beforeDestroy:function(){global._baseTree.removePage(this)}};function p(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}i._baseTree=new c;var h=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.events={}}return function(e,n,t){n&&p(e.prototype,n),t&&p(e,t)}(e,[{key:"on",value:function(e,n){"function"==typeof n?(this.events[e]=this.events[e]||[]).push(n):console.error("callback handler must be a function")}},{key:"emit",value:function(e){if(this.events[e]&&0<this.events[e].length){var n=this.events[e];if(n)for(var t=[].slice.call(arguments,1),o=0,r=n.length;o<r;o++)n[o].apply(null,t)}}},{key:"off",value:function(e,n){if(this.events=this.events||{},arguments.length){var t=this.events[e];t&&(1!==arguments.length?(t.splice(t.indexOf(n)>>>0,1),this.events[e]=t):delete this.events[e])}else this.events={}}}]),e}(),d={created:function(){this._event=new h},beforeDestroy:function(){this._off(),delete this._event},methods:{_getCurrentPageComponents:function(e){return this._page._children[e]||[]},_on:function(){var e;(e=this._event).on.apply(e,arguments)},_off:function(){var e;(e=this._event).off.apply(e,arguments)},_emit:function(){var e;(e=this._event).emit.apply(e,arguments)},_broadcast:function(e){for(var n=arguments.length,t=new Array(1<n?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];this._getCurrentPageComponents(e).forEach(function(e){var n;(n=e._event).emit.apply(n,t)})}}},v={methods:{_getCurrentPageComponents:function(e){return this._children[e]||[]},_broadcast:function(e){for(var n=arguments.length,t=new Array(1<n?n-1:0),o=1;o<n;o++)t[o-1]=arguments[o];this._getCurrentPageComponents(e).forEach(function(e){var n;(n=e._event).emit.apply(n,t)})}}};e.global=n,e.promise=t,e.wxTools=o,e.dayjs=r,e.Event=h,e.autoRequire2array=function(n){return n.keys().map(function(e){return n(e).default})},e.autoRequire2object=function(r){return r.keys().reduce(function(e,n){var t=n.replace(/^\.\/(.*)\.\w+$/,"$1"),o=r(n);return e[t]=o.default,e},{})},e.componentBaseTreeMixin=l,e.componentEventMixin=d,e.pageBaseTreeMixin=f,e.pageEventMixin=v,Object.defineProperty(e,"__esModule",{value:!0})});
